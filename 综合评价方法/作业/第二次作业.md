
[[评价指标预处理]]
# 习题一：指标正向化

|           | x_1  | x_2  | x_3  | x_4  | x_5  | x_6  |
| --------- | ---- | ---- | ---- | ---- | ---- | ---- |
| project_1 | 6    | 50   | 41   | 7    | 43   | 68   |
| project_2 | 4    | 63   | 95   | 6    | 38   | 72   |
| project_3 | 9    | 79   | 77   | 8    | 69   | 46   |
| project_4 | 3    | 82   | 63   | 4    | 81   | 89   |
| project_5 | 8    | 68   | 82   | 6    | 56   | 73   |
| project_6 | 8    | 91   | 79   | 8    | 75   | 59   |

​	对逆向指标进行正向化，此处采用了**最小阈值法**
$$
y_1 = \frac{x_{min}}{x_i}
$$
​	对适度指标采用**绝对值倒数法**
$$
y = \frac{1}{|x_0-x_i|}
$$
​	区间指标则使用了区间指标正向化的方法
$$
y_i=
\left\{\begin{array}{lr}
1-\frac{q_1-x_i}{\max \left\{q_1-m, M-q_2\right\}} & x<q_1 
\\
1 & x \in\left[q_1, q_2\right] 
\\
1-\frac{x_i-q_2}{\max \left\{q_1-m, M-q_2\right\}} & x>q_2
\end{array}\right.
$$
​	通过使用以下代码，进行了指标的处理：

```python
import pandas as pd

data = pd.read_excel("source")

def op_for_col34(i):
    y = (min(data.iloc[:,i]))/data.iloc[:,3]

    return y

def op_for_col56(i,num):
    y = 1/(abs(num-data.iloc[:,i]))

    return y

def op_for_col78(i,q1,q2):
    x = data.iloc[:,i]
    m = min(x)
    M = max(x)
    data.loc[x<q1, data.columns[i]] = 1-(q1-x[x<q1])/max(q1-m,M-q2)
    data.loc[(q1<=x) & (x<=q2), data.columns[i]] = 1
    data.loc[x>q2, data.columns[i]] = 1-(x[x>q2]-q2)/max(q1-m,M-q2)

    return data.iloc[:, i]

for i in [3,4]:
    data.iloc[:,i] = op_for_col34(i)

data.iloc[:,5] = op_for_col56(5,num=60)
data.iloc[:,6] = op_for_col56(6,num=65)

data.iloc[:,7] = op_for_col78(7,65,85)
data.iloc[:,8] = op_for_col78(8,40,70)
```

​	最后得到的正向化的指标如下：

|           | x_1  | x_2  | x_3   | x_4   | x_5   | x_6   |
| --------- | ---- | ---- | ----- | ----- | ----- | ----- |
| project_1 | 6    | 50   | 1     | 4     | 0.059 | 0.333 |
| project_2 | 4    | 63   | 0.432 | 9.268 | 0.045 | 0.143 |
| project_3 | 9    | 79   | 0.532 | 7.512 | 0.111 | 0.053 |
| project_4 | 3    | 82   | 0.651 | 6.146 | 0.048 | 0.042 |
| project_5 | 8    | 68   | 0.5   | 8     | 0.25  | 0.125 |
| project_6 | 8    | 91   | 0.519 | 7.707 | 0.067 | 0.167 |



# 习题二：指标无量纲化

| 地区       | 生产总值(亿元) | 人均生产总值(元/人) | 社会消费品零售总额（亿元） | 全社会固定资产投资增速(%) |
| ---------- | -------------- | ------------------- | -------------------------- | ------------------------- |
| 西安市     | 8349.86        | 85114               | 4658.72                    | 8.4                       |
| 铜川市     | 327.96         | 40065               | 153.54                     | 13.8                      |
| 宝鸡市     | 2265.16        | 59988               | 864.6                      | 12.1                      |
| 咸阳市     | 2376.45        | 54368               | 674.19                     | 9.0                       |
| 渭南市     | 1767.71        | 33009               | 719.87                     | 14.5                      |
| 延安市     | 1558.91        | 68940               | 314.98                     | 6.9                       |
| 汉中市     | 1471.88        | 42754               | 469.29                     | 14.0                      |
| 榆林市     | 3848.62        | 112845              | 514.11                     | 8.5                       |
| 安康市     | 1133.77        | 42544               | 332.68                     | 16.1                      |
| 商洛市     | 824.77         | 34674               | 214.95                     | 8.5                       |
| 杨凌示范区 | 150.46         | 72388               | 21.35                      | 12.9                      |



## 方法一：阈值法

​	对于以上数据采取阈值法进行无量纲化。
$$
y=\frac{x_0}{x}
$$
​	我选取了最小值作为阈值。

​	使用了以下代码：

```python
def yuzhi(i):
    x = data2.iloc[:,i]
    m = min(x)
    y = m/x

    return y

for i in [1,2,3,4]:
    data2.iloc[:,i] = yuzhi(i)

data2 = data2.round(3)
```

​	得到的结果如下：

| 地区       | 生产总值(亿元) | 人均生产总值(元/人) | 社会消费品零售总额（亿元） | 全社会固定资产投资增速(%) |
| ---------- | -------------- | ------------------- | -------------------------- | ------------------------- |
| 西安市     | 0.018          | 0.388               | 0.005                      | 0.821                     |
| 铜川市     | 0.459          | 0.824               | 0.139                      | 0.5                       |
| 宝鸡市     | 0.066          | 0.55                | 0.025                      | 0.57                      |
| 咸阳市     | 0.063          | 0.607               | 0.032                      | 0.767                     |
| 渭南市     | 0.085          | 1                   | 0.03                       | 0.476                     |
| 延安市     | 0.097          | 0.479               | 0.068                      | 1                         |
| 汉中市     | 0.102          | 0.772               | 0.045                      | 0.493                     |
| 榆林市     | 0.039          | 0.293               | 0.042                      | 0.812                     |
| 安康市     | 0.133          | 0.776               | 0.064                      | 0.429                     |
| 商洛市     | 0.182          | 0.952               | 0.099                      | 0.812                     |
| 杨凌示范区 | 1              | 0.456               | 1                          | 0.535                     |



## 方法二：中心化法

​	对于以上数据通过中心化法进行无量纲化。
$$
y=\frac{x}{E}
$$
​	以下是实现代码：

```python
def zxh(i):
    x = data2.iloc[:,i]
    m = x.mean()
    y = x/m

    return y

for i in [1,2,3,4]:
    data2.iloc[:,i] = zxh(i)

data2 = data2.round(3)
```

​	得到的结果如下：

| 地区       | 生产总值(亿元) | 人均生产总值(元/人) | 社会消费品零售总额（亿元） | 全社会固定资产投资增速(%) |
| ---------- | -------------- | ------------------- | -------------------------- | ------------------------- |
| 西安市     | 3.815          | 1.448               | 5.733                      | 0.741                     |
| 铜川市     | 0.15           | 0.681               | 0.189                      | 1.217                     |
| 宝鸡市     | 1.035          | 1.02                | 1.064                      | 1.067                     |
| 咸阳市     | 1.086          | 0.925               | 0.83                       | 0.794                     |
| 渭南市     | 0.808          | 0.561               | 0.886                      | 1.279                     |
| 延安市     | 0.712          | 1.173               | 0.388                      | 0.609                     |
| 汉中市     | 0.672          | 0.727               | 0.578                      | 1.235                     |
| 榆林市     | 1.758          | 1.919               | 0.633                      | 0.75                      |
| 安康市     | 0.518          | 0.724               | 0.409                      | 1.42                      |
| 商洛市     | 0.377          | 0.59                | 0.265                      | 0.75                      |
| 杨凌示范区 | 0.069          | 1.231               | 0.026                      | 1.138                     |



## 方法三：规格化

​	对于以上数据通过规格化进行无量纲处理。
$$
y = \frac{x-min}{max-min}
$$
​	以下是实现代码：

```python
def ggh(i):
    x = data2.iloc[:,i]
    m = min(x)
    M = max(x)
    y = (x-m)/(M-m)

    return y

for i in [1,2,3,4]:
    data2.iloc[:,i] = ggh(i)

data2 = data2.round(3)
```

​	得到的结果如下：

| 地区       | 生产总值(亿元) | 人均生产总值(元/人) | 社会消费品零售总额（亿元） | 全社会固定资产投资增速(%) |
| ---------- | -------------- | ------------------- | -------------------------- | ------------------------- |
| 西安市     | 1              | 0.653               | 1                          | 0.163                     |
| 铜川市     | 0.022          | 0.088               | 0.029                      | 0.75                      |
| 宝鸡市     | 0.258          | 0.338               | 0.182                      | 0.565                     |
| 咸阳市     | 0.271          | 0.268               | 0.141                      | 0.228                     |
| 渭南市     | 0.197          | 0                   | 0.151                      | 0.826                     |
| 延安市     | 0.172          | 0.45                | 0.063                      | 0                         |
| 汉中市     | 0.161          | 0.122               | 0.097                      | 0.772                     |
| 榆林市     | 0.451          | 1                   | 0.106                      | 0.174                     |
| 安康市     | 0.12           | 0.119               | 0.067                      | 1                         |
| 商洛市     | 0.082          | 0.021               | 0.042                      | 0.174                     |
| 杨凌示范区 | 0              | 0.493               | 0                          | 0.652                     |



## 方法四：标准化

​	使用标准化对数据进行无量纲化。
$$
y = \frac{x-E}{s}
$$
​	实现代码如下：

```python
def ggh(i):
    x = data2.iloc[:,i]
    m = x.mean()
    s = x.std()
    y = (x-m)/(s)

    return y

for i in [1,2,3,4]:
    data2.iloc[:,i] = ggh(i)

data2 = data2.round(3)
```

​	得到的结果如下：

| 地区       | 生产总值(亿元) | 人均生产总值(元/人) | 社会消费品零售总额（亿元） | 全社会固定资产投资增速(%) |
| ---------- | -------------- | ------------------- | -------------------------- | ------------------------- |
| 西安市     | 2.691          | 1.071               | 2.956                      | -0.934                    |
| 铜川市     | -0.813         | -0.762              | -0.507                     | 0.784                     |
| 宝鸡市     | 0.033          | 0.049               | 0.04                       | 0.243                     |
| 咸阳市     | 0.082          | -0.18               | -0.106                     | -0.744                    |
| 渭南市     | -0.184         | -1.049              | -0.071                     | 1.007                     |
| 延安市     | -0.275         | 0.413               | -0.382                     | -1.412                    |
| 汉中市     | -0.313         | -0.652              | -0.264                     | 0.848                     |
| 榆林市     | 0.725          | 2.199               | -0.229                     | -0.903                    |
| 安康市     | -0.461         | -0.661              | -0.369                     | 1.516                     |
| 商洛市     | -0.596         | -0.981              | -0.459                     | -0.903                    |
| 杨凌示范区 | -0.89          | 0.553               | -0.608                     | 0.498                     |



## 方法五：比重法

​	通过比重法对以上数据进行无量纲化。
$$
y=\frac{x_i}{\Sigma_{i}^{n}x_i}
$$
​	以下是代码实现：

```python
def bzf(i):
    x = data2.iloc[:,i]
    s = x.sum()
    y = (x)/(s)

    return y

for i in [1,2,3,4]:
    data2.iloc[:,i] = bzf(i)

data2 = data2.round(3)
```

​	得到的结果如下：

| 地区       | 生产总值(亿元) | 人均生产总值(元/人) | 社会消费品零售总额（亿元） | 全社会固定资产投资增速(%) |
| ---------- | -------------- | ------------------- | -------------------------- | ------------------------- |
| 西安市     | 0.347          | 0.132               | 0.521                      | 0.067                     |
| 铜川市     | 0.014          | 0.062               | 0.017                      | 0.111                     |
| 宝鸡市     | 0.094          | 0.093               | 0.097                      | 0.097                     |
| 咸阳市     | 0.099          | 0.084               | 0.075                      | 0.072                     |
| 渭南市     | 0.073          | 0.051               | 0.081                      | 0.116                     |
| 延安市     | 0.065          | 0.107               | 0.035                      | 0.055                     |
| 汉中市     | 0.061          | 0.066               | 0.053                      | 0.112                     |
| 榆林市     | 0.16           | 0.174               | 0.058                      | 0.068                     |
| 安康市     | 0.047          | 0.066               | 0.037                      | 0.129                     |
| 商洛市     | 0.034          | 0.054               | 0.024                      | 0.068                     |
| 杨凌示范区 | 0.006          | 0.112               | 0.002                      | 0.103                     |

